import{d as D,s as $,j as u,o as s,c as f,l as i,u as d,n as b,p as P,k as _,w as a,m as k,a as m,F as I,v as T,_ as Q,i as J,r as O,e as K,G as W,H as X,z,M as Y}from"./index-BN_aPgIH.js";import{e as Z}from"./examPaper-Cs26uEvk.js";import{e as ee}from"./examPaperAnswer-BO6Ie7rU.js";import{u as R}from"./enumitem-C4DHP3Rz.js";import{f as te}from"./date-BTOyOhzP.js";const ne={class:"operator-block"},oe={class:"operator-content"},se={class:"operator-title"},ae={key:0,class:"num"},re=["innerHTML"],le={class:"op-content"},ie={class:"question-prefix"},de=["innerHTML"],ue={class:"question-prefix"},ce=["innerHTML"],me={class:"question-prefix"},pe=["innerHTML"],_e=D({__name:"QuestionEdit",props:{question:{type:Object,default:()=>({})},qLoading:{type:Boolean,default:!1},qType:{type:Number,default:0},answer:{type:Object,default(){return{id:null,content:"",contentArray:[]}}}},emits:["update:answer"],setup(q,{emit:S}){const y=q,M=S,{question:r,qType:l}=y,A=$(()=>(r==null?void 0:r.items)||[]),v=$({get:()=>{var c;return((c=y.answer)==null?void 0:c.content)||""},set:c=>{const n={...y.answer,content:c,completed:!0};M("update:answer",n)}}),w=$({get:()=>{var c,n;if(l===4){const p=[...((c=y.answer)==null?void 0:c.contentArray)||[]];for(;p.length<A.value.length;)p.push("");return p}return((n=y.answer)==null?void 0:n.contentArray)||[]},set:c=>{const n={...y.answer,contentArray:c,completed:!0};M("update:answer",n)}}),U=(c,n)=>{const p=[...w.value];p[c]=String(n),w.value=p},V=R(),B=$(()=>V.exam.question.typeEnum);return(c,n)=>{const p=u("t-tag"),o=u("t-radio"),t=u("t-radio-group"),g=u("t-checkbox"),C=u("t-checkbox-group"),h=u("t-input"),E=u("t-form-item"),F=u("t-textarea");return s(),f("div",ne,[i("div",oe,[i("div",se,[d(r).itemOrder?(s(),f("div",ae,b(d(r).itemOrder),1)):P("",!0),d(l)===4||d(l)===5?(s(),_(p,{key:1,theme:"warning"},{default:a(()=>n[4]||(n[4]=[k("人工批阅")])),_:1})):(s(),_(p,{key:2,theme:"success"},{default:a(()=>n[5]||(n[5]=[k("机器批阅")])),_:1})),m(p,null,{default:a(()=>[k(b(d(V).enumFormat(B.value,d(l))),1)]),_:1}),i("h1",{innerHTML:d(r).title},null,8,re)]),i("div",le,[d(l)==1?(s(),_(t,{key:0,modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),disabled:q.qLoading},{default:a(()=>[(s(!0),f(I,null,T(d(r).items,e=>(s(),_(o,{key:e.prefix,value:e.prefix},{default:a(()=>[i("span",ie,b(e.prefix)+".",1),i("span",{class:"q-item-span-content",innerHTML:e.content},null,8,de)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])):d(l)==2?(s(),_(C,{key:1,modelValue:w.value,"onUpdate:modelValue":n[1]||(n[1]=e=>w.value=e),disabled:q.qLoading},{default:a(()=>[(s(!0),f(I,null,T(d(r).items,e=>(s(),_(g,{key:e.prefix,value:e.prefix},{default:a(()=>[i("span",ue,b(e.prefix)+".",1),i("span",{class:"q-item-span-content",innerHTML:e.content},null,8,ce)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])):d(l)==3?(s(),_(t,{key:2,modelValue:v.value,"onUpdate:modelValue":n[2]||(n[2]=e=>v.value=e),disabled:q.qLoading},{default:a(()=>[(s(!0),f(I,null,T(d(r).items,e=>(s(),_(o,{key:e.prefix,label:e.prefix},{default:a(()=>[i("span",me,b(e.prefix)+".",1),i("span",{class:"q-item-span-content",innerHTML:e.content},null,8,pe)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])):d(l)==4?(s(!0),f(I,{key:3},T(d(r).items,(e,L)=>(s(),_(E,{key:e.prefix,label:e.prefix,"label-width":"50px",style:{"margin-top":"10px","margin-bottom":"10px"}},{default:a(()=>[m(h,{value:w.value[L],disabled:q.qLoading,onChange:N=>U(L,N)},null,8,["value","disabled","onChange"])]),_:2},1032,["label"]))),128)):d(l)==5?(s(),_(F,{key:4,modelValue:v.value,"onUpdate:modelValue":n[3]||(n[3]=e=>v.value=e),rows:"5",disabled:q.qLoading},null,8,["modelValue","disabled"])):P("",!0)])])])}}}),fe=Q(_e,[["__scopeId","data-v-829c841c"]]),ve={class:"paper-item-order-fake"},ge={class:"paper-item-order"},ye={class:"do-exam-time"},xe={class:"time"},be={class:"paper-question-content"},he={key:0,class:"question-list-box"},qe={class:"list-box"},we={class:"list-qu"},ke=D({__name:"do",setup(q){const S=J(),y=R(),M=$(()=>y.exam.question.answer.doCompletedTag),r=O({}),l=O({questionId:null,doTime:0,answerItems:[]}),A=O(null),v=O(0),w=()=>{l.value.id=r.value.id;const o=r.value.titleItems;for(const t in o){const g=o[t].questionItems;for(const C in g){const h=g[C];l.value.answerItems.push({questionId:h.id,content:null,contentArray:[],completed:!1,itemOrder:h.itemOrder})}}},U=()=>{A.value=setInterval(()=>{v.value<=0?V():(++l.value.doTime,--v.value)},1e3)},V=()=>{window.clearInterval(A.value),ee.answerSubmit(l.value).then(o=>{const t=X.alert({header:"考试结果",body:`试卷得分：${o}分`,confirmBtn:"返回考试记录",onConfirm:()=>{z.push("/record/index"),t.destroy()},onClose:()=>{z.push("/record/index"),t.hide()}})}).catch(o=>{Y.warning(o.messgae)})},B=o=>{console.log(o);const t=l.value.answerItems[o.itemOrder-1];t&&(t.content=o.content,t.contentArray=o.contentArray,t.completed=o.completed)},c=o=>y.enumFormat(M.value,o),n=O(null),p=o=>{var g;const t=(g=n.value)==null?void 0:g.querySelector(o);t&&t.scrollIntoView({behavior:"instant",block:"center",inline:"nearest"})};return K(()=>{const{id:o}=S.query;o&&parseInt(o,10)!==0&&Z.select(o).then(t=>{r.value=t,v.value=t.suggestTime*60,w(),console.log(l.value),U()})}),W(()=>{window.clearInterval(A.value)}),(o,t)=>{const g=u("t-descriptions-item"),C=u("t-descriptions"),h=u("t-divider"),E=u("t-tag"),F=u("t-space"),e=u("t-button"),L=u("t-card"),N=u("t-form-item");return s(),f("div",{ref_key:"root",ref:n,class:"do-exam"},[i("div",ve,[i("div",ge,[m(L,{title:r.value.name,"header-bordered":""},{default:a(()=>[m(C,{size:"small",layout:"vertical"},{default:a(()=>[m(g,{label:"试卷总分"},{default:a(()=>[k(b(r.value.score)+"分",1)]),_:1}),m(g,{label:"考试时间"},{default:a(()=>[k(b(r.value.suggestTime)+"分钟",1)]),_:1})]),_:1}),m(h,{dashed:""}),m(F,{"break-line":"",size:"small"},{default:a(()=>[(s(!0),f(I,null,T(l.value.answerItems,x=>(s(),f("span",{key:x.itemOrder},[m(E,{theme:c(x.completed),class:"do-exam-title-tag",onClick:j=>p("#question-"+x.itemOrder)},{default:a(()=>[k(b(x.itemOrder),1)]),_:2},1032,["theme","onClick"])]))),128))]),_:1}),m(h,{dashed:""}),i("div",ye,[t[2]||(t[2]=i("div",{class:"title"},"剩余时间",-1)),i("div",xe,b(d(te)(v.value)),1),m(h,{dashed:""}),m(e,{onClick:t[0]||(t[0]=x=>V())},{default:a(()=>t[1]||(t[1]=[k("提交试卷")])),_:1})])]),_:1},8,["title"])])]),i("div",be,[(s(!0),f(I,null,T(r.value.titleItems,(x,j)=>(s(),_(L,{key:j,title:x.name,"header-bordered":""},{default:a(()=>[x.questionItems.length!==0?(s(),f("div",he,[(s(!0),f(I,null,T(x.questionItems,(H,G)=>(s(),_(N,{id:"question-"+H.itemOrder,key:G,style:{"margin-bottom":"0px"}},{default:a(()=>[i("div",qe,[i("div",we,[m(fe,{question:H,"q-type":H.questionType,answer:l.value.answerItems[H.itemOrder-1],"onUpdate:answer":B},null,8,["question","q-type","answer"])])])]),_:2},1032,["id"]))),128))])):P("",!0)]),_:2},1032,["title"]))),128))])],512)}}}),Le=Q(ke,[["__scopeId","data-v-5bce0b5f"]]);export{Le as default};
