import{d as Z,i as ee,g as te,H as le,v as j,r as C,S as ae,e as oe,M as p,j as s,o as m,c as v,a as t,w as a,l as u,m as r,n as h,F as b,C as y,k as V,_ as ne}from"./index-DXJQNOID.js";import{q as L}from"./QuestionShowContent-CnIlYcF9.js";import{u as se}from"./enumitem-j20-ZoDl.js";import{_ as ue}from"./QuestionShow.vue_vue_type_script_setup_true_lang-DNZVCb38.js";import{I as A}from"./constants-CezdDX0L.js";const re={class:"form-basic-container"},ie={class:"form-basic-item"},de={class:"form-basic-container-title"},me={style:{display:"flex",width:"100%"}},ce={style:{flex:"1"}},fe={class:"form-submit-container"},pe={class:"form-submit-sub"},_e={class:"form-submit-left"},ve=Z({__name:"single-choice",setup(ge){const T=ee(),z=te(),w=le(),N=se(),R=j(()=>N.user.levelEnum),k=j(()=>w.subjects),q=C(),g=C(!1),o=C({...A}),B={gradeLevel:[{required:!0,message:"请选择年级",trigger:"change"}],subjectId:[{required:!0,message:"请选择学科",trigger:"change"}],title:[{required:!0,message:"请输入题干",trigger:"blur"}],analyze:[{required:!0,message:"请输入解析",trigger:"blur"}],score:[{required:!0,message:"请输入分数",trigger:"blur"}],correct:[{required:!0,message:"请选择正确答案",trigger:"change"}],difficult:[{required:!0,message:"请选择难度",trigger:"change"}]},f=ae({qType:0,dialog:!1,question:{}}),F=()=>{o.value.subjectId=void 0,q.value=k.value.filter(n=>n.level===o.value.gradeLevel)},M=()=>{f.qType=1,f.dialog=!0,f.question=o.value},D=()=>{o.value={...A},p.success("重置成功")},H=({validateResult:n,firstError:e})=>{e?(console.log("Errors: ",n),p.warning(e)):L.edit(o.value).then(i=>{p.success(o.value.id?"修改成功":"添加成功"),z.push("/question")}).catch(i=>{console.log("Errors: ",i),p.warning(i.message)})},O=n=>{if(o.value.items.length===2){p.warning("至少需要保留两个选项");return}o.value.items.splice(n,1),o.value.items.forEach((e,i)=>{e.prefix=String.fromCharCode(65+i)})},P=()=>{const{items:n}=o.value;let e;if(n.length>0){const i=n[n.length-1];e=String.fromCharCode(i.prefix.charCodeAt(0)+1)}else e="A";n.push({prefix:e,content:""})};return oe(()=>{const{id:n}=T.query;n&&parseInt(n,10)!==0&&(o.value.id=n,g.value=!0,L.select(n).then(e=>{o.value=e,g.value=!1}).catch(e=>{g.value=!1,p.error(e.message)})),w.initSubject(()=>{q.value=k.value})}),(n,e)=>{const i=s("t-tag"),I=s("t-option"),E=s("t-select"),c=s("t-form-item"),d=s("t-col"),x=s("t-input"),_=s("t-button"),$=s("t-input-adornment"),S=s("t-row"),G=s("t-radio"),Q=s("t-radio-group"),J=s("t-input-number"),K=s("t-rate"),W=s("t-form"),X=s("t-loading");return m(),v("div",null,[t(X,{loading:g.value},{default:a(()=>[t(W,{ref:"form",class:"base-form",data:o.value,rules:B,"label-align":"top","label-width":100,onReset:D,onSubmit:H},{default:a(()=>[u("div",re,[u("div",ie,[u("div",de,[e[8]||(e[8]=u("span",null,"单选题管理",-1)),e[9]||(e[9]=r()),t(i,{theme:"primary"},{default:a(()=>[r(h(o.value.id?"修改":"新增"),1)]),_:1})]),t(S,{class:"row-gap",gutter:[32,24]},{default:a(()=>[t(d,{span:6},{default:a(()=>[t(c,{label:"题目年级",name:"gradeLevel"},{default:a(()=>[t(E,{modelValue:o.value.gradeLevel,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.gradeLevel=l),class:"form-item-content",placeholder:"请选择题目年级",clearable:"",onChange:F},{default:a(()=>[e[10]||(e[10]=r(" > ")),(m(!0),v(b,null,y(R.value,l=>(m(),V(I,{key:l.key,label:l.value,value:l.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(c,{label:"题目学科",name:"subjectId"},{default:a(()=>[t(E,{modelValue:o.value.subjectId,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.subjectId=l),class:"form-item-content",placeholder:"请选择题目学科",clearable:""},{default:a(()=>[e[11]||(e[11]=r(" > ")),(m(!0),v(b,null,y(q.value,l=>(m(),V(I,{key:l.id,label:l.name+" ( "+l.levelName+" )",value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{label:"题目主干",name:"title"},{default:a(()=>[t(x,{modelValue:o.value.title,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.title=l),class:"form-item-content",placeholder:"请输入题目主干"},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{"required-mark":""},{label:a(()=>[e[13]||(e[13]=u("span",null,"题目选项",-1)),t(_,{style:{"margin-left":"10px"},size:"small",theme:"primary",onClick:P},{default:a(()=>e[12]||(e[12]=[r("添加选项")])),_:1})]),default:a(()=>[t(S,{gutter:[8,8],style:{"margin-top":"10px",width:"100%"}},{default:a(()=>[(m(!0),v(b,null,y(o.value.items,(l,Y)=>(m(),V(d,{key:l.prefix,span:12},{default:a(()=>[u("div",me,[u("div",ce,[t($,{prepend:l.prefix},{default:a(()=>[t(x,{modelValue:l.content,"onUpdate:modelValue":U=>l.content=U,placeholder:"请输入题目选项内容"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prepend"])]),t(_,{style:{"margin-left":"10px",height:"auto"},size:"small",theme:"danger",onClick:U=>O(Y)},{default:a(()=>e[14]||(e[14]=[r("删除")])),_:2},1032,["onClick"])])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{label:"标准答案",name:"correct"},{default:a(()=>[t(Q,{modelValue:o.value.correct,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.correct=l)},{default:a(()=>[(m(!0),v(b,null,y(o.value.items,l=>(m(),V(G,{key:l.prefix,value:l.prefix},{default:a(()=>[r(h(l.prefix),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{label:"解析",name:"analyze"},{default:a(()=>[t(x,{modelValue:o.value.analyze,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.analyze=l),class:"form-item-content",placeholder:"请输入解析"},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(c,{label:"分数",name:"score"},{default:a(()=>[t(J,{modelValue:o.value.score,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.score=l),"auto-width":"","decimal-places":1,min:0,class:"form-item-content",placeholder:"请输入分数"},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(c,{label:"难度",name:"difficult"},{default:a(()=>[t(K,{modelValue:o.value.difficult,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.difficult=l),class:"form-item-content","show-text":"",texts:["入门","简单","中等","困难","专家"]},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),u("div",fe,[u("div",pe,[u("div",_e,[t(_,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:a(()=>[r(h(o.value.id?"修改":"添加")+"题目 ",1)]),_:1}),t(_,{class:"form-submit-confirm",onClick:M},{default:a(()=>e[15]||(e[15]=[r(" 预览题目 ")])),_:1}),t(_,{type:"reset",class:"form-submit-cancel",theme:"default",variant:"base"},{default:a(()=>e[16]||(e[16]=[r(" 重置题目 ")])),_:1})])])])]),_:1},8,["data"]),t(ue,{visible:f.dialog,"onUpdate:visible":e[7]||(e[7]=l=>f.dialog=l),question:f.question,"q-type":f.qType},null,8,["visible","question","q-type"])]),_:1},8,["loading"])])}}}),Ce=ne(ve,[["__scopeId","data-v-7608891e"]]);export{Ce as default};
