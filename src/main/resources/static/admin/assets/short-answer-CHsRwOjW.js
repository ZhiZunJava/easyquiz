import{d as W,i as $,g as G,H as J,v as x,r as V,S as K,e as X,M as f,j as s,o as p,c as q,a as t,w as o,l as d,m,n as S,F as k,C as E,k as L,_ as Y}from"./index-DXJQNOID.js";import{q as U}from"./QuestionShowContent-CnIlYcF9.js";import{u as Z}from"./enumitem-j20-ZoDl.js";import{_ as ee}from"./QuestionShow.vue_vue_type_script_setup_true_lang-DNZVCb38.js";import{d as C}from"./constants-CezdDX0L.js";const te={class:"form-basic-container"},le={class:"form-basic-item"},ae={class:"form-basic-container-title"},oe={class:"form-submit-container"},se={class:"form-submit-sub"},ne={class:"form-submit-left"},ue=W({__name:"short-answer",setup(re){const T=$(),R=G(),y=J(),h=Z(),N=x(()=>h.user.levelEnum),w=x(()=>y.subjects),_=V(),v=V(!1),l=V({...C}),A={gradeLevel:[{required:!0,message:"请选择年级",trigger:"change"}],subjectId:[{required:!0,message:"请选择学科",trigger:"change"}],title:[{required:!0,message:"请输入题干",trigger:"blur"}],analyze:[{required:!0,message:"请输入解析",trigger:"blur"}],score:[{required:!0,message:"请输入分数",trigger:"blur"}],correct:[{required:!0,message:"请输入答案",trigger:"blur"}],difficult:[{required:!0,message:"请选择难度",trigger:"change"}]},u=K({qType:0,dialog:!1,question:{}}),z=()=>{l.value.subjectId=void 0,_.value=w.value.filter(n=>n.level===l.value.gradeLevel)},B=()=>{u.qType=5,u.dialog=!0,u.question=l.value},F=()=>{l.value={...C},f.success("重置成功")},M=({validateResult:n,firstError:e})=>{e?(console.log("Errors: ",n),f.warning(e)):U.edit(l.value).then(c=>{f.success(l.value.id?"修改成功":"添加成功"),R.push("/question")}).catch(c=>{console.log("Errors: ",c),f.warning(c.message)})};return X(()=>{const{id:n}=T.query;n&&parseInt(n,10)!==0&&(l.value.id=n,v.value=!0,U.select(n).then(e=>{l.value=e,v.value=!1}).catch(e=>{v.value=!1,f.error(e.message)})),y.initSubject(()=>{_.value=w.value})}),(n,e)=>{const c=s("t-tag"),I=s("t-option"),j=s("t-select"),r=s("t-form-item"),i=s("t-col"),g=s("t-input"),D=s("t-input-number"),H=s("t-rate"),O=s("t-row"),b=s("t-button"),P=s("t-form"),Q=s("t-loading");return p(),q("div",null,[t(Q,{loading:v.value},{default:o(()=>[t(P,{ref:"form",class:"base-form",data:l.value,rules:A,"label-align":"top","label-width":100,onReset:F,onSubmit:M},{default:o(()=>[d("div",te,[d("div",le,[d("div",ae,[e[8]||(e[8]=d("span",null,"简答题管理",-1)),e[9]||(e[9]=m()),t(c,{theme:"primary"},{default:o(()=>[m(S(l.value.id?"修改":"新增"),1)]),_:1})]),t(O,{class:"row-gap",gutter:[32,24]},{default:o(()=>[t(i,{span:6},{default:o(()=>[t(r,{label:"题目年级",name:"gradeLevel"},{default:o(()=>[t(j,{modelValue:l.value.gradeLevel,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.gradeLevel=a),class:"form-item-content",placeholder:"请选择题目年级",clearable:"",onChange:z},{default:o(()=>[e[10]||(e[10]=m(" > ")),(p(!0),q(k,null,E(N.value,a=>(p(),L(I,{key:a.key,label:a.value,value:a.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(i,{span:6},{default:o(()=>[t(r,{label:"题目学科",name:"subjectId"},{default:o(()=>[t(j,{modelValue:l.value.subjectId,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.subjectId=a),class:"form-item-content",placeholder:"请选择题目学科",clearable:""},{default:o(()=>[e[11]||(e[11]=m(" > ")),(p(!0),q(k,null,E(_.value,a=>(p(),L(I,{key:a.id,label:a.name+" ( "+a.levelName+" )",value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(i,{span:12},{default:o(()=>[t(r,{label:"题目主干",name:"title"},{default:o(()=>[t(g,{modelValue:l.value.title,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.title=a),class:"form-item-content",placeholder:"请输入题目主干"},null,8,["modelValue"])]),_:1})]),_:1}),t(i,{span:12},{default:o(()=>[t(r,{label:"标准答案",name:"correct"},{default:o(()=>[t(g,{modelValue:l.value.correct,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.correct=a),class:"form-item-content",placeholder:"请输入答案"},null,8,["modelValue"])]),_:1})]),_:1}),t(i,{span:12},{default:o(()=>[t(r,{label:"解析",name:"analyze"},{default:o(()=>[t(g,{modelValue:l.value.analyze,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.analyze=a),class:"form-item-content",placeholder:"请输入解析"},null,8,["modelValue"])]),_:1})]),_:1}),t(i,{span:6},{default:o(()=>[t(r,{label:"分数",name:"score"},{default:o(()=>[t(D,{modelValue:l.value.score,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.score=a),"auto-width":"","decimal-places":1,min:0,class:"form-item-content",placeholder:"请输入分数"},null,8,["modelValue"])]),_:1})]),_:1}),t(i,{span:6},{default:o(()=>[t(r,{label:"难度",name:"difficult"},{default:o(()=>[t(H,{modelValue:l.value.difficult,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.difficult=a),class:"form-item-content","show-text":"",texts:["入门","简单","中等","困难","专家"]},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),d("div",oe,[d("div",se,[d("div",ne,[t(b,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:o(()=>[m(S(l.value.id?"修改":"添加")+"题目 ",1)]),_:1}),t(b,{class:"form-submit-confirm",onClick:B},{default:o(()=>e[12]||(e[12]=[m(" 预览题目 ")])),_:1}),t(b,{type:"reset",class:"form-submit-cancel",theme:"default",variant:"base"},{default:o(()=>e[13]||(e[13]=[m(" 重置题目 ")])),_:1})])])])]),_:1},8,["data"]),t(ee,{visible:u.dialog,"onUpdate:visible":e[7]||(e[7]=a=>u.dialog=a),question:u.question,"q-type":u.qType},null,8,["visible","question","q-type"])]),_:1},8,["loading"])])}}}),pe=Y(ue,[["__scopeId","data-v-86253f70"]]);export{pe as default};
