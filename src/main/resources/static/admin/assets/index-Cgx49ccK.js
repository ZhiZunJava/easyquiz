import{q as w}from"./QuestionShowContent-CnIlYcF9.js";import{d as ue,H as se,v,r as i,S as ie,e as re,j as u,o as m,c as y,a,w as o,m as r,F as x,C as j,n as B,u as N,t as L,l as ce,M,I as de,k as I,_ as me}from"./index-DXJQNOID.js";import{u as ve}from"./enumitem-j20-ZoDl.js";import{_ as fe}from"./QuestionShow.vue_vue_type_script_setup_true_lang-DNZVCb38.js";const pe={class:"list-common-table"},_e={class:"table-container"},ye="id",be="top",ge=!0,qe=ue({__name:"index",setup(he){const b=se(),c=ve(),z=v(()=>c.user.levelEnum),E=v(()=>c.exam.question.typeEnum),O=v(()=>c.user.difficulty),n=i({questionType:void 0,subjectId:void 0,level:void 0}),V=i([]),Q=i(0),g=i(-1),q=i(!1),_=i(!1),S=i(),K=v(()=>b.subjects),A=v(()=>c.exam.question.editUrlEnum),d=ie({qType:0,dialog:!1,question:{}}),H=[{title:"ID",colKey:"id",width:100},{title:"学科名称",colKey:"subjectId",width:150,cell:(t,{row:e})=>b.subjectEnumFormat(K.value,e.subjectId)},{title:"题目类型",colKey:"questionType",width:150,cell:(t,{row:e})=>c.enumFormat(E.value,e.questionType)},{title:"题目标题",colKey:"shortTitle",ellipsis:{theme:"light"}},{title:"分数",colKey:"score",width:80},{title:"难度",colKey:"difficult",width:80,cell:(t,{row:e})=>`${e.difficult} (${c.enumFormat(O.value,e.difficult)})`},{title:"操作时间",colKey:"createTime",width:200},{align:"left",fixed:"right",width:160,colKey:"op",title:"操作"}],s=i({defaultPageSize:20,total:100,defaultCurrent:1}),P=t=>{w.select(t.id).then(e=>{d.qType=e.questionType,d.question=e,d.dialog=!0})},R=t=>{var e;(e=t.pagination)!=null&&e.current&&(s.value.defaultCurrent=t.pagination.current,f())},f=async()=>{q.value=!0;try{const t={...n.value,pageIndex:s.value.defaultCurrent,pageSize:s.value.defaultPageSize};Object.keys(t).forEach(e=>{t[e]===""&&(t[e]=null)}),await w.pageList(t).then(e=>{V.value=e.list,Q.value=e.total,s.value={...s.value,total:e.total}})}catch(t){console.log(t)}finally{q.value=!1}},G=()=>{Object.keys(n.value).forEach(t=>{n.value[t]===""&&(n.value[t]=null)}),s.value.defaultCurrent=1,f()},J=()=>{s.value.defaultCurrent=1,f()},W=t=>{g.value=t,_.value=!0},D=()=>{g.value=-1},X=v(()=>"删除后，该问题的所有信息将被清空，且无法恢复"),Y=()=>{D()},Z=async()=>{await w.deleteQuestion(g.value).then(()=>{_.value=!1,M.success("删除成功"),D(),f()}).catch(t=>{M.error(t)})},ee=()=>{n.value.subjectId=void 0,S.value=K.value.filter(t=>t.level===n.value.level)},te=t=>{const e=c.enumFormat(A.value,t.questionType);de.push({path:e,query:{id:t.id}})};return re(()=>{b.initSubject(),f()}),(t,e)=>{const h=u("t-option"),C=u("t-select"),k=u("t-form-item"),p=u("t-col"),F=u("t-row"),U=u("t-button"),le=u("t-form"),T=u("t-link"),ae=u("t-space"),oe=u("t-table"),ne=u("t-dialog");return m(),y("div",pe,[a(le,{ref:"form",data:n.value,"label-width":80,colon:"",onReset:J,onSubmit:G},{default:o(()=>[a(F,null,{default:o(()=>[a(p,{span:10},{default:o(()=>[a(F,{gutter:[24,24]},{default:o(()=>[a(p,{span:4},{default:o(()=>[a(k,{label:"题目年级",name:"level"},{default:o(()=>[a(C,{modelValue:n.value.level,"onUpdate:modelValue":e[0]||(e[0]=l=>n.value.level=l),class:"form-item-content",placeholder:"请选择题目年级",clearable:"",onChange:ee},{default:o(()=>[e[5]||(e[5]=r(" > ")),(m(!0),y(x,null,j(z.value,l=>(m(),I(h,{key:l.key,label:l.value,value:l.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(p,{span:4},{default:o(()=>[a(k,{label:"题目学科",name:"subjectId"},{default:o(()=>[a(C,{modelValue:n.value.subjectId,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value.subjectId=l),class:"form-item-content",placeholder:"请选择题目学科",clearable:""},{default:o(()=>[e[6]||(e[6]=r(" > ")),(m(!0),y(x,null,j(S.value,l=>(m(),I(h,{key:l.id,label:l.name+" ( "+l.levelName+" )",value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(p,{span:4},{default:o(()=>[a(k,{label:"题目类型",name:"questionType"},{default:o(()=>[a(C,{modelValue:n.value.questionType,"onUpdate:modelValue":e[2]||(e[2]=l=>n.value.questionType=l),class:"form-item-content",placeholder:"请选择题目类型",clearable:""},{default:o(()=>[e[7]||(e[7]=r(" > ")),(m(!0),y(x,null,j(E.value,l=>(m(),I(h,{key:l.key,label:l.value,value:l.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(p,{span:2,class:"operation-container"},{default:o(()=>[a(U,{theme:"primary",type:"submit"},{default:o(()=>[r(B(N(L)("components.commonTable.query")),1)]),_:1}),a(U,{type:"reset",variant:"base",theme:"default"},{default:o(()=>[r(B(N(L)("components.commonTable.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),ce("div",_e,[a(oe,{data:V.value,columns:H,"row-key":ye,"vertical-align":be,hover:ge,pagination:s.value,loading:q.value,onChange:R},{op:o(l=>[a(ae,null,{default:o(()=>[a(T,{theme:"primary",onClick:$=>P(l.row)},{default:o(()=>e[8]||(e[8]=[r(" 预览 ")])),_:2},1032,["onClick"]),a(T,{theme:"primary",onClick:$=>te(l.row)},{default:o(()=>e[9]||(e[9]=[r(" 编辑 ")])),_:2},1032,["onClick"]),a(T,{theme:"danger",onClick:$=>W(l.row.id)},{default:o(()=>e[10]||(e[10]=[r(" 删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination","loading"]),a(ne,{visible:_.value,"onUpdate:visible":e[3]||(e[3]=l=>_.value=l),header:"确认删除当前所选问题？",body:X.value,"on-cancel":Y,onConfirm:Z},null,8,["visible","body"]),a(fe,{visible:d.dialog,"onUpdate:visible":e[4]||(e[4]=l=>d.dialog=l),question:d.question,"q-type":d.qType},null,8,["visible","question","q-type"])])])}}}),xe=me(qe,[["__scopeId","data-v-410941a1"]]);export{xe as default};
