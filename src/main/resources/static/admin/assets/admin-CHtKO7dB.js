import{d as E,r as c,R as q,j as n,o as O,k as X,w as l,a as e,m as f,P as x,M as N,K as Y,N as Z,v as ee,e as te,c as le,n as B,u as S,t as M,l as ae,_ as oe}from"./index-DXJQNOID.js";const ne=E({__name:"DialogAdminForm",props:{visible:{type:Boolean,default:!1},data:Object},emits:["update:visible","refresh"],setup(U,{emit:C}){const p={id:null,role:1,userName:"",password:"",realName:"",age:void 0,sex:1,userLevel:void 0,status:1},v=c(!1),s=c({...p}),b=C,h=({validateResult:r,firstError:a})=>{a?(console.log("Errors: ",r),N.warning(a)):x.createUser(s.value).then(_=>{N.success(s.value.id?"修改成功":"添加成功"),v.value=!1,b("refresh")}).catch(_=>{console.log("Errors: ",_),N.warning(_.message)})},y=()=>{v.value=!1,s.value={...p}};q(()=>v.value,r=>{b("update:visible",r)}),q(()=>U.visible,r=>{v.value=r}),q(()=>U.data,r=>{r&&(s.value=r)});const w={userName:[{required:!0,message:"请输入用户名",type:"error",trigger:"blur"}],realName:[{required:!0,message:"请输入姓名",type:"error",trigger:"blur"}],userLevel:[{required:!0,message:"请选择年级",type:"error",trigger:"blur"}],status:[{required:!0,message:"请选择状态",type:"error",trigger:"blur"}]};return(r,a)=>{const _=n("t-input"),u=n("t-form-item"),D=n("t-input-number"),g=n("t-radio"),I=n("t-radio-group"),V=n("t-button"),A=n("t-form"),k=n("t-dialog");return O(),X(k,{visible:v.value,"onUpdate:visible":a[5]||(a[5]=i=>v.value=i),header:s.value.id?"修改用户":"新增用户",width:680,footer:!1},{body:l(()=>[e(A,{ref:"form",data:s.value,rules:w,"label-width":100,onSubmit:h},{default:l(()=>[e(u,{label:"用户名",name:"userName"},{default:l(()=>[e(_,{modelValue:s.value.userName,"onUpdate:modelValue":a[0]||(a[0]=i=>s.value.userName=i),style:{width:"480px"},autocomplete:"off",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(u,{label:"密码",name:"password"},{default:l(()=>[e(_,{modelValue:s.value.password,"onUpdate:modelValue":a[1]||(a[1]=i=>s.value.password=i),style:{width:"480px"},autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(u,{label:"姓名",name:"realName"},{default:l(()=>[e(_,{modelValue:s.value.realName,"onUpdate:modelValue":a[2]||(a[2]=i=>s.value.realName=i),placeholder:"请输入姓名",style:{width:"480px"}},null,8,["modelValue"])]),_:1}),e(u,{label:"年龄",name:"age"},{default:l(()=>[e(D,{modelValue:s.value.age,"onUpdate:modelValue":a[3]||(a[3]=i=>s.value.age=i),placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1}),e(u,{label:"状态",name:"status"},{default:l(()=>[e(I,{modelValue:s.value.status,"onUpdate:modelValue":a[4]||(a[4]=i=>s.value.status=i)},{default:l(()=>[e(g,{value:1},{default:l(()=>a[6]||(a[6]=[f("启用")])),_:1}),e(g,{value:2},{default:l(()=>a[7]||(a[7]=[f("禁用")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{style:{float:"right"}},{default:l(()=>[e(V,{variant:"outline",onClick:y},{default:l(()=>a[8]||(a[8]=[f("取消")])),_:1}),e(V,{theme:"primary",type:"submit"},{default:l(()=>a[9]||(a[9]=[f("确定")])),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}}),se={class:"list-common-table"},ue={class:"table-container"},re="id",ie="top",de=!0,me=E({__name:"admin",setup(U){const C={id:null,userName:"",password:"",realName:"",age:18,sex:1,userLevel:void 0,status:1,role:3},p=c({role:3,userName:null}),v=c([]),s=c(0),b=c(-1),h=c(!1),y=c(!1),w=c(!1),r=c({...C}),a={1:{label:"启用",theme:"success",icon:e(Y,null,null)},2:{label:"禁用",theme:"danger",icon:e(Z,null,null)}},_=[{title:"ID",colKey:"id",width:50},{title:"用户UUID",colKey:"userUuid",width:150,ellipsis:{theme:"light",showArrow:!1}},{title:"用户名",colKey:"userName",width:150},{title:"真实姓名",colKey:"realName",width:150},{colKey:"status",title:"状态",width:120,cell:(o,{row:t})=>{const d=a[t.status];return e(n("t-tag"),{shape:"round",theme:d==null?void 0:d.theme,variant:"light-outline"},{default:()=>[d==null?void 0:d.icon,d==null?void 0:d.label]})}},{title:"操作时间",colKey:"createTime",width:200},{align:"left",fixed:"right",width:160,colKey:"op",title:"操作"}],u=c({defaultPageSize:20,total:100,defaultCurrent:1}),D=o=>{var t;(t=o.pagination)!=null&&t.current&&(u.value.defaultCurrent=o.pagination.current,g())},g=async()=>{h.value=!0;try{const o={...p.value,pageIndex:u.value.defaultCurrent,pageSize:u.value.defaultPageSize};Object.keys(o).forEach(t=>{o[t]===""&&(o[t]=null)}),await x.getUserPageList(o).then(t=>{v.value=t.list,s.value=t.total,u.value={...u.value,total:t.total}})}catch(o){console.log(o)}finally{h.value=!1}},I=()=>{Object.keys(p.value).forEach(o=>{p.value[o]===""&&(p.value[o]=null)}),u.value.defaultCurrent=1,g()},V=()=>{u.value.defaultCurrent=1,g()},A=o=>{b.value=o,y.value=!0},k=()=>{b.value=-1},i=ee(()=>"删除后，该用户的所有信息将被清空，且无法恢复"),P=()=>{k()},z=async()=>{await x.deleteUser(b.value).then(()=>{y.value=!1,N.success("删除成功"),k(),g()}).catch(o=>{N.error(o)})},$=o=>{o?x.selectUser(o).then(t=>{r.value=t}):r.value={...C},w.value=!0};return te(()=>{g()}),(o,t)=>{const d=n("t-input"),F=n("t-form-item"),K=n("t-col"),j=n("t-row"),L=n("t-button"),R=n("t-form"),T=n("t-link"),W=n("router-link"),G=n("t-space"),H=n("t-table"),J=n("t-dialog");return O(),le("div",se,[e(R,{ref:"form",data:p.value,"label-width":80,colon:"",onReset:V,onSubmit:I},{default:l(()=>[e(j,null,{default:l(()=>[e(K,{span:10},{default:l(()=>[e(j,{gutter:[24,24]},{default:l(()=>[e(K,{span:4},{default:l(()=>[e(F,{label:"用户名",name:"userName"},{default:l(()=>[e(d,{modelValue:p.value.userName,"onUpdate:modelValue":t[0]||(t[0]=m=>p.value.userName=m),class:"form-item-content",type:"search",placeholder:"用户名",style:{minWidth:"134px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(K,{span:2,class:"operation-container"},{default:l(()=>[e(L,{theme:"primary",onClick:t[1]||(t[1]=m=>$())},{default:l(()=>[f(B(S(M)("components.commonTable.add")),1)]),_:1}),e(L,{theme:"primary",type:"submit"},{default:l(()=>[f(B(S(M)("components.commonTable.query")),1)]),_:1}),e(L,{type:"reset",variant:"base",theme:"default"},{default:l(()=>[f(B(S(M)("components.commonTable.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),ae("div",ue,[e(H,{data:v.value,columns:_,"row-key":re,"vertical-align":ie,hover:de,pagination:u.value,loading:h.value,onChange:D},{op:l(m=>[e(G,null,{default:l(()=>[e(T,{theme:"primary",onClick:Q=>$(m.row.id)},{default:l(()=>t[5]||(t[5]=[f(" 编辑 ")])),_:2},1032,["onClick"]),e(W,{to:{path:"/log/index",query:{userId:m.row.id}}},{default:l(()=>[e(T,{theme:"primary"},{default:l(()=>t[6]||(t[6]=[f(" 日志 ")])),_:1})]),_:2},1032,["to"]),e(T,{theme:"danger",onClick:Q=>A(m.row.id)},{default:l(()=>t[7]||(t[7]=[f(" 删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination","loading"]),e(J,{visible:y.value,"onUpdate:visible":t[2]||(t[2]=m=>y.value=m),header:"确认删除当前所选用户？",body:i.value,"on-cancel":P,onConfirm:z},null,8,["visible","body"]),e(ne,{visible:w.value,"onUpdate:visible":t[3]||(t[3]=m=>w.value=m),data:r.value,onRefresh:t[4]||(t[4]=m=>g())},null,8,["visible","data"])])])}}}),pe=oe(me,[["__scopeId","data-v-d7a96f2b"]]);export{pe as default};
