import{d as Z,i as ee,g as te,H as le,v as L,r as h,S as ae,e as oe,M as p,j as s,o as m,c as v,a as t,w as a,l as u,m as r,n as C,F as b,C as y,k as x,_ as ne}from"./index-DXJQNOID.js";import{q as j}from"./QuestionShowContent-CnIlYcF9.js";import{u as se}from"./enumitem-j20-ZoDl.js";import{_ as ue}from"./QuestionShow.vue_vue_type_script_setup_true_lang-DNZVCb38.js";import{a as S}from"./constants-CezdDX0L.js";const re={class:"form-basic-container"},ie={class:"form-basic-item"},de={class:"form-basic-container-title"},me={style:{display:"flex",width:"100%"}},ce={style:{flex:"1"}},fe={class:"form-submit-container"},pe={class:"form-submit-sub"},_e={class:"form-submit-left"},ve=Z({__name:"multiple-choice",setup(ge){const T=ee(),z=te(),k=le(),R=se(),M=L(()=>R.user.levelEnum),w=L(()=>k.subjects),V=h(),g=h(!1),o=h({...S}),N={gradeLevel:[{required:!0,message:"请选择年级",trigger:"change"}],subjectId:[{required:!0,message:"请选择学科",trigger:"change"}],title:[{required:!0,message:"请输入题干",trigger:"blur"}],analyze:[{required:!0,message:"请输入解析",trigger:"blur"}],score:[{required:!0,message:"请输入分数",trigger:"blur"}],correctArray:[{required:!0,message:"请选择正确答案",trigger:"change"}],difficult:[{required:!0,message:"请选择难度",trigger:"change"}]},f=ae({qType:0,dialog:!1,question:{}}),B=()=>{o.value.subjectId=void 0,V.value=w.value.filter(n=>n.level===o.value.gradeLevel)},F=()=>{f.qType=2,f.dialog=!0,f.question=o.value},D=()=>{o.value={...S},p.success("重置成功")},P=({validateResult:n,firstError:e})=>{e?(console.log("Errors: ",n),p.warning(e)):j.edit(o.value).then(i=>{p.success(o.value.id?"修改成功":"添加成功"),z.push("/question")}).catch(i=>{console.log("Errors: ",i),p.warning(i.message)})},H=n=>{if(o.value.items.length===3){p.warning("至少需要保留三个选项");return}o.value.items.splice(n,1),o.value.items.forEach((e,i)=>{e.prefix=String.fromCharCode(65+i)})},O=()=>{const{items:n}=o.value;let e;if(n.length>0){const i=n[n.length-1];e=String.fromCharCode(i.prefix.charCodeAt(0)+1)}else e="A";n.push({prefix:e,content:"",id:null})};return oe(()=>{const{id:n}=T.query;n&&parseInt(n,10)!==0&&(o.value.id=n,g.value=!0,j.select(n).then(e=>{o.value=e,g.value=!1}).catch(e=>{g.value=!1,p.error(e.message)})),k.initSubject(()=>{V.value=w.value})}),(n,e)=>{const i=s("t-tag"),I=s("t-option"),A=s("t-select"),c=s("t-form-item"),d=s("t-col"),q=s("t-input"),_=s("t-button"),$=s("t-input-adornment"),U=s("t-row"),Q=s("t-checkbox"),G=s("t-checkbox-group"),J=s("t-input-number"),K=s("t-rate"),W=s("t-form"),X=s("t-loading");return m(),v("div",null,[t(X,{loading:g.value},{default:a(()=>[t(W,{ref:"form",class:"base-form",data:o.value,rules:N,"label-align":"top","label-width":100,onReset:D,onSubmit:P},{default:a(()=>[u("div",re,[u("div",ie,[u("div",de,[e[8]||(e[8]=u("span",null,"多选题管理",-1)),e[9]||(e[9]=r()),t(i,{theme:"primary"},{default:a(()=>[r(C(o.value.id?"修改":"新增"),1)]),_:1})]),t(U,{class:"row-gap",gutter:[32,24]},{default:a(()=>[t(d,{span:6},{default:a(()=>[t(c,{label:"题目年级",name:"gradeLevel"},{default:a(()=>[t(A,{modelValue:o.value.gradeLevel,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.gradeLevel=l),class:"form-item-content",placeholder:"请选择题目年级",clearable:"",onChange:B},{default:a(()=>[e[10]||(e[10]=r(" > ")),(m(!0),v(b,null,y(M.value,l=>(m(),x(I,{key:l.key,label:l.value,value:l.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(c,{label:"题目学科",name:"subjectId"},{default:a(()=>[t(A,{modelValue:o.value.subjectId,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.subjectId=l),class:"form-item-content",placeholder:"请选择题目学科",clearable:""},{default:a(()=>[e[11]||(e[11]=r(" > ")),(m(!0),v(b,null,y(V.value,l=>(m(),x(I,{key:l.id,label:l.name+" ( "+l.levelName+" )",value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{label:"题目主干",name:"title"},{default:a(()=>[t(q,{modelValue:o.value.title,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.title=l),class:"form-item-content",placeholder:"请输入题目主干"},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{"required-mark":""},{label:a(()=>[e[13]||(e[13]=u("span",null,"题目选项",-1)),t(_,{style:{"margin-left":"10px"},size:"small",theme:"primary",onClick:O},{default:a(()=>e[12]||(e[12]=[r("添加选项")])),_:1})]),default:a(()=>[t(U,{gutter:[8,8],style:{"margin-top":"10px",width:"100%"}},{default:a(()=>[(m(!0),v(b,null,y(o.value.items,(l,Y)=>(m(),x(d,{key:l.prefix,span:12},{default:a(()=>[u("div",me,[u("div",ce,[t($,{prepend:l.prefix},{default:a(()=>[t(q,{modelValue:l.content,"onUpdate:modelValue":E=>l.content=E,placeholder:"请输入题目选项内容"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prepend"])]),t(_,{style:{"margin-left":"10px",height:"auto"},size:"small",theme:"danger",onClick:E=>H(Y)},{default:a(()=>e[14]||(e[14]=[r("删除")])),_:2},1032,["onClick"])])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{label:"标准答案",name:"correctArray"},{default:a(()=>[t(G,{modelValue:o.value.correctArray,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.correctArray=l)},{default:a(()=>[(m(!0),v(b,null,y(o.value.items,l=>(m(),x(Q,{key:l.prefix,value:l.prefix},{default:a(()=>[r(C(l.prefix),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(c,{label:"解析",name:"analyze"},{default:a(()=>[t(q,{modelValue:o.value.analyze,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.analyze=l),class:"form-item-content",placeholder:"请输入解析"},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(c,{label:"分数",name:"score"},{default:a(()=>[t(J,{modelValue:o.value.score,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.score=l),"auto-width":"","decimal-places":1,min:0,class:"form-item-content",placeholder:"请输入分数"},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:6},{default:a(()=>[t(c,{label:"难度",name:"difficult"},{default:a(()=>[t(K,{modelValue:o.value.difficult,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.difficult=l),class:"form-item-content","show-text":"",texts:["入门","简单","中等","困难","专家"]},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),u("div",fe,[u("div",pe,[u("div",_e,[t(_,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:a(()=>[r(C(o.value.id?"修改":"添加")+"题目 ",1)]),_:1}),t(_,{class:"form-submit-confirm",onClick:F},{default:a(()=>e[15]||(e[15]=[r(" 预览题目 ")])),_:1}),t(_,{type:"reset",class:"form-submit-cancel",theme:"default",variant:"base"},{default:a(()=>e[16]||(e[16]=[r(" 重置题目 ")])),_:1})])])])]),_:1},8,["data"]),t(ue,{visible:f.dialog,"onUpdate:visible":e[7]||(e[7]=l=>f.dialog=l),question:f.question,"q-type":f.qType},null,8,["visible","question","q-type"])]),_:1},8,["loading"])])}}}),he=ne(ve,[["__scopeId","data-v-32256031"]]);export{he as default};
